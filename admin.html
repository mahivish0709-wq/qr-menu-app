<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>管理画面</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>メニュー登録</h1>
    <input id="n" type="text" placeholder="料理名（例：牛丼）">
    <input id="p" type="number" placeholder="価格（例：800）">
    <button id="b">登録する</button>
    <p id="s"></p>

    <script>
        // ボタンに直接命令を出す「確実な方法」に変更しました
        window.onload = function() {
            const URL = "https://ooyvztatkhadbquwimhz.supabase.co";
            const KEY = "sb_publishable_X43uA6B8_axn9ZJ2nLHvSw_lfv1W7m5O8K89O8yYf_nN8E8T8S8T8R8A8M8I8"; 
            const supabase = supabasejs.createClient(URL, KEY);
            const btn = document.getElementById('b');

            btn.addEventListener('click', async () => {
                const name = document.getElementById('n').value;
                const price = document.getElementById('p').value;
                const status = document.getElementById('s');

                if(!name || !price) {
                    alert("料理名と価格を入力してください");
                    return;
                }

                status.innerText = "⏳ 保存中...";
                
                try {
                    const { error } = await supabase
                        .from('menus')
                        .insert([{ name_ja: name, price: parseInt(price) }]);

                    if (error) throw error;
                    status.innerText = "✅ 登録完了！";
                } catch (err) {
                    status.innerText = "❌ エラー: " + err.message;
                    console.error(err);
                }
            });
        };
    </script>
</body>
</html>

