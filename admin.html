<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>管理画面</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; }
        input, button { font-size: 18px; padding: 12px; margin: 10px; border-radius: 8px; border: 1px solid #ccc; }
        button { background-color: #4CAF50; color: white; border: none; cursor: pointer; width: 220px; font-weight: bold; }
        #status { margin-top: 20px; font-weight: bold; color: #666; }
    </style>
</head>
<body>
    <h2>メニュー登録</h2>
    <input id="n" type="text" placeholder="料理名" value="牛丼">
    <input id="p" type="number" placeholder="価格" value="800">
    <button id="b">登録を実行する</button>
    <div id="status"></div>

    <script>
        // あなたが送ってくれた「本物の長いKEY」を正確にセットしました
        const URL = "https://ooyvztatkhadbquwimhz.supabase.co";
        const KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9veXZ6dGF0a2hhZGJxdXdpbWh6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3MjAxNTQsImV4cCI6MjA4NDI5NjE1NH0.8j_E3GTtXfe0ufDVksZhjHYfWVQIGw6nino80USV8no"; 

        window.onload = function() {
            const supabase = supabasejs.createClient(URL, KEY);
            const btn = document.getElementById('b');
            const status = document.getElementById('status');

            btn.onclick = async function() {
                const name = document.getElementById('n').value;
                const price = document.getElementById('p').value;

                if(!name || !price) return alert("入力してください");
                
                status.innerText = "⏳ データベースへ送信中...";
                btn.disabled = true;

                try {
                    const { error } = await supabase
                        .from('menus')
                        .insert([{ name_ja: name, price: parseInt(price) }]);

                    if (error) {
                        alert("エラー: " + error.message);
                        status.innerText = "❌ 失敗";
                    } else {
                        alert("✅ 成功！牛丼が登録されました！");
                        status.innerText = "✅ 登録完了しました！";
                    }
                } catch (e) {
                    alert("接続失敗: " + e.message);
                } finally {
                    btn.disabled = false;
                }
            };
        };
    </script>
</body>
</html>
