<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h3>メニュー登録</h3>
    <input id="n" type="text" placeholder="料理名">
    <input id="p" type="number" placeholder="価格">
    <button id="b">登録を実行する</button>
    <div id="s"></div>

    <script>
        // 画面が読み込まれてから確実にボタンとプログラムを繋ぐ書き方です
        window.onload = function() {
            const URL = "https://ooyvztatkhadbquwimhz.supabase.co";
            const KEY = "sb_publishable_X43uA6B8_axn9ZJ2nLHvSw_lfv1W7m5O8K89O8yYf_nN8E8T8S8T8R8A8M8I8"; 
            const supabase = supabasejs.createClient(URL, KEY);

            document.getElementById('b').onclick = async function() {
                const name = document.getElementById('n').value;
                const price = document.getElementById('p').value;
                const status = document.getElementById('s');

                if(!name || !price) {
                    alert("名前と価格を入れてください");
                    return;
                }

                status.innerText = "通信中...";

                try {
                    const { error } = await supabase
                        .from('menus')
                        .insert([{ name_ja: name, price: parseInt(price) }]);

                    if (error) throw error;
                    status.innerText = "✅ 成功！牛丼を登録しました！";
                } catch (e) {
                    status.innerText = "❌ 失敗: " + e.message;
                    console.error(e);
                }
            };
        };
    </script>
</body>
</html>
